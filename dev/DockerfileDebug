FROM golang:1.20
# Build Delve
RUN go install github.com/go-delve/delve/cmd/dlv@latest
WORKDIR /fedbox
ENV HOSTNAME localhost:30000

ADD . /fedbox
ADD ./.env.dist ./.env
RUN  make download all
#CMD ["/fedbox/bin/fedbox"]
CMD ["dlv", "--listen=:40000", "--headless=true", "--api-version=2", "--accept-multiclient", "exec", "/fedbox/bin/fedbox"]